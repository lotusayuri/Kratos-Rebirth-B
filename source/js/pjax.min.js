"use strict";$((function(){if(window.history&&window.history.pushState&&window.history.replaceState){window.addEventListener("popstate",(function(n){n.state&&(t(),"undefined"==typeof n.state.content?c(location.href,!1):r(n.state),window.dispatchEvent(e.complete))}));var e={before:new Event("pjax:before"),success:new Event("pjax:success"),complete:new Event("pjax:complete"),error:new Event("pjax:error")};$(document).on("click","a[target!=_blank][rel!=gallery][class!=toc-link]",(function(){var e=$(this).attr("href");return void 0===e||(!!e.includes("javascript:")||(c(decodeURI(e),!0),!1))}))}function t(){var e=document.getElementById("kratos-blog-post").offsetTop,t=document.getElementById("kratos-desktop-topnav").offsetHeight,n=t?e-t:0;$("body,html").animate({scrollTop:n},600)}function n(e,t,n){var o=e.querySelector('meta[property="'+t+'"]');if(o)n?o.setAttribute("content",n):o.parentNode&&o.parentNode.removeChild(o);else{if(!n)return;(o=e.createElement("meta")).setAttribute("property",t),o.setAttribute("content",n),e.head.appendChild(o)}}function o(e,t){var n=e.querySelector('meta[property="'+t+'"]');return n?n.getAttribute("content"):null}function r(e,t){if(document.title=e.title||"Untitled",t){var o=document.getElementById("main");"function"==typeof o.replaceWith?o.replaceWith(t.getElementById("main")):document.getElementById("main").innerHTML=e.content}else document.getElementById("main").innerHTML=e.content;for(var r=document.getElementById("main").getElementsByTagName("script"),i=0;i<r.length;i++){var c=r[i];if(!c.type||"text/javascript"===c.type.toLowerCase()){var a=document.createElement("script");a.setAttribute("type","text/javascript"),c.src?a.src=c.src:a.appendChild(document.createTextNode(c.text)),"function"==typeof c.replaceWith?c.replaceWith(a):(c.parentNode.insertBefore(a,c),c.parentNode.removeChild(c))}}n(document,"og:title",e.ogTitle),n(document,"og:url",e.ogUrl)}function i(e){return{title:e.title,ogTitle:o(e,"og:title"),ogUrl:o(e,"og:url"),content:e.getElementById("main").innerHTML}}function c(n,o){var c=function(){location.href=n,window.dispatchEvent(e.error)},a=new XMLHttpRequest;a.onerror=function(e){console.error(e),c(),bubbleNoticer("请求出错啦","err","3000")},a.ontimeout=function(){c()},a.onreadystatechange=function(){4===a.readyState&&function(t){window.dispatchEvent(e.success);var c=document.implementation.createHTMLDocument("pjax");if(c.documentElement.innerHTML=t,c.getElementById("main")){history.replaceState(i(document),document.title,location.href);var a=i(c);bubbleNoticer("请求成功","ok","3000"),o&&window.history.pushState(a,a.title,n),r(a,c);var l=n.match(/\#.+$/);l&&$("body,html").animate({scrollTop:$(l[0]).offset().top-40},600)}else bubbleNoticer("似乎超时了，准备三秒后新建页面","problem","3000"),setTimeout((function(){window.open(n)}),3500);NProgress.done(),window.dispatchEvent(e.complete)}(a.responseText)},a.open("GET",n,!0),a.timeout=6e3,"undefined"!=typeof load_comm&&null!==load_comm&&(load_comm=null),t(),NProgress.start(),bubbleNoticer("请求页面中","normal","3000"),window.dispatchEvent(e.before),a.send()}}));
//# sourceMappingURL=../maps/pjax.min.js.map
